{"version":3,"names":[],"mappings":"","sources":["script.js"],"sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.getPopupCleanClass = getPopupCleanClass;\nexports.closePopup = closePopup;\nexports.closeAllPopups = closeAllPopups;\nexports.openPopup = openPopup;\n\n// function getButtonLink(buttonElement) {\n//     var buttonClassNames = buttonElement.attr(\"class\").split(\" \");\n//     var buttonLinkToPopup;\n//     for (var i = buttonClassNames.length-1; i >= 0; i--) {\n//         if(buttonClassNames[i].lastIndexOf('openPopup') !== 0){\n//             buttonClassNames.splice(i, 1);\n//         } else {\n//             buttonLinkToPopup = buttonClassNames[i].substring(4, buttonClassNames[i].length);\n//         }\n//     }\n//     return buttonLinkToPopup.charAt(0).toLowerCase() + buttonLinkToPopup.slice(1); // returning lowercased name of popup to open\n// }\n\nfunction getPopupCleanClass(popupElement) {\n    var classNames = popupElement.closest(\".popup.active\").getAttribute(\"class\").split(\" \");\n    for (var i = classNames.length; i >= 0; i--) {\n        if (classNames[i] === \"popup\" || classNames[i] === \"active\") {\n            classNames.splice(i, 1);\n        }\n    }\n    var classOfPopup = classNames.join(\".\");\n    return classOfPopup; // returning popup class to close\n}\n\nfunction closePopup(className) {\n    document.getElementsByClassName(className)[0].classList.remove(\"active\");\n    // console.log(\"Closed popup with class: '\" + className + \"'\");\n}\n\nfunction closeAllPopups() {\n    document.getElementsByClassName(\"popup\")[0].classList.remove(\"active\");\n    // console.log(\"closed all popups\");\n}\n\nfunction openPopup(popupToOpen) {\n    closeAllPopups();\n    document.getElementsByClassName(popupToOpen)[0].classList.add(\"active\");\n    // console.log(\"Opened popup with class: '\" + popupToOpen + \"'\");\n}\n\n},{}],2:[function(require,module,exports){\n'use strict';\n\nvar _popup = require('./modules/popup');\n\nwindow.onload = function () {\n\n    console.log('Ready!');\n\n    (function () {\n\n        var REST_API_URL = \"https://jsonplaceholder.typicode.com/\";\n\n        // initialization\n        initialiseAlbum();\n\n        // handling buttons\n        document.getElementsByClassName(\"btnSidePrev\")[0].onclick = function () {\n            // previous button click \n            nextAlbum(-1);\n        };\n\n        document.getElementsByClassName(\"btnSideNext\")[0].onclick = function () {\n            // next button click\n            nextAlbum(1);\n        };\n\n        document.getElementsByClassName(\"popup__close-button\")[0].onclick = function () {\n            // closing popup with close button\n            var cleanClass = (0, _popup.getPopupCleanClass)(this);\n            (0, _popup.closePopup)(cleanClass);\n            setTimeout(deleteBigImage, 500);\n        };\n\n        document.getElementsByClassName(\"popup\")[0].onclick = function () {\n            // closing popup with click outside\n            var cleanClass = (0, _popup.getPopupCleanClass)(this);\n            (0, _popup.closePopup)(cleanClass);\n            setTimeout(deleteBigImage, 500);\n        };\n\n        document.getElementsByClassName(\"popup__main\")[0].onclick = function (e) {\n            // preventing closing on clicking main form content\n            e.stopPropagation();\n        };\n\n        // interface realisation\n        function initialiseAlbum() {\n            // set initial album state\n            fetchImages(1);\n            fetchAlbumName(1);\n        }\n\n        function fetchImages(albumNumber) {\n            // getting album images by album number\n            fetch(REST_API_URL + 'photos?albumId=' + albumNumber).then(function (response) {\n                return response.json();\n            }).then(function (json) {\n                json.forEach(function (item) {\n                    createAlbumItem(item[\"title\"], item[\"thumbnailUrl\"], item[\"url\"]);\n                });\n            });\n        }\n\n        function fetchAlbumName(albumNumber) {\n            // getting album name by album number\n            fetch(REST_API_URL + 'albums?id=' + albumNumber).then(function (response) {\n                return response.json();\n            }).then(function (json) {\n                document.getElementsByClassName(\"albumTitleNumber\")[0].textContent = json[0][\"title\"];\n                var scrollButtons = document.getElementsByClassName(\"btnScrollAlbum\");\n                Array.prototype.forEach.call(scrollButtons, function (button) {\n                    button.disabled = false;\n                });\n            });\n        }\n\n        function nextAlbum(direction) {\n            // showing next or previous album (direction 1: forward; -1: backward)\n            var albumTitle = document.getElementsByClassName(\"albumTitleNumber\")[0].innerHTML;\n            var scrollButtons = document.getElementsByClassName(\"btnScrollAlbum\");\n            var albumId = 0;\n            var albumsAmount = 0;\n            deleteAlbumItems();\n            Array.prototype.forEach.call(scrollButtons, function (button) {\n                button.disabled = true;\n            });\n            fetch(REST_API_URL + 'albums').then(function (response) {\n                return response.json();\n            }).then(function (json) {\n                json.forEach(function (item) {\n                    if (item[\"id\"] > albumsAmount) {\n                        albumsAmount = item[\"id\"];\n                    }\n                    if (item[\"title\"] === albumTitle) {\n                        albumId = item[\"id\"];\n                    }\n                });\n                console.log(\"Total albums amount: \" + albumsAmount);\n                albumId += direction;\n                if (albumId < 1) {\n                    albumId = albumsAmount;\n                } else if (albumId > albumsAmount) {\n                    albumId = 1;\n                }\n                fetchImages(albumId);\n                fetchAlbumName(albumId);\n                console.log(\"Current album id: \" + albumId);\n            });\n        }\n\n        function createBigPicturePopup(bigImageURL) {\n            // creating and inserting big picture in picture popup\n            var bigImage = document.createElement(\"img\");\n            bigImage.src = bigImageURL;\n            document.getElementsByClassName(\"popup__content\")[0].appendChild(bigImage);\n            (0, _popup.openPopup)(\"popupPic\");\n        }\n\n        function createAlbumItem(picTitle, thumbnailURL, imageURL) {\n            // creating album items with onclick events \n\n            var albumItemTitle = document.createElement(\"div\");\n            albumItemTitle.className = \"albumItemTitle\";\n            albumItemTitle.innerHTML = picTitle;\n\n            var albumItemImage = document.createElement(\"div\");\n            albumItemImage.className = \"albumItemImage\";\n\n            var albumImg = document.createElement(\"img\");\n            albumImg.src = thumbnailURL;\n            albumImg.setAttribute(\"data-url\", imageURL);\n\n            var albumItemContent = document.createElement(\"div\");\n            albumItemContent.className = \"albumItemContent\";\n\n            var albumItem = document.createElement(\"div\");\n            albumItem.className = \"albumItem\";\n            albumItem.onclick = function (e) {\n                var bigURL = e.target.closest(\".albumItem\").querySelector('.albumItemImage img').getAttribute(\"data-url\");\n                createBigPicturePopup(bigURL);\n            };\n\n            albumItem.appendChild(albumItemContent);\n            albumItemContent.appendChild(albumItemTitle);\n            albumItemContent.appendChild(albumItemImage);\n            albumItemImage.appendChild(albumImg);\n\n            document.getElementsByClassName(\"albumItemsWrapper\")[0].appendChild(albumItem);\n        }\n\n        function deleteAlbumItems() {\n            // clear album items wrapper\n            document.getElementsByClassName(\"albumItemsWrapper\")[0].innerHTML = \"\";\n        }\n        function deleteBigImage() {\n            // clear big image popup\n            document.getElementsByClassName(\"popup__content\")[0].innerHTML = \"\";\n        }\n    })();\n};\n\n},{\"./modules/popup\":1}]},{},[2]);\n"],"file":"script.js"}